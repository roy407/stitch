#!/bin/sh

MSG_FILE="$1"
MSG=$(sed -n '1p' "$MSG_FILE")

REGEX="^\\[(feat|fix|docs|style|refactor|perf|test|chore)\\](\\[[a-zA-Z0-9._/-]+(,[a-zA-Z0-9._/-]+)*\\])?: .{1,72}$"

if ! echo "$MSG" | grep -Eq "$REGEX"; then
  echo ""
  echo "❌ Commit message 不符合规范"
  echo ""
  echo "正确格式："
  echo "  [feat][decoder]: add h264_cuvid support"
  echo "  [feat][decoder,rtsp]: support zero-copy pipeline"
  echo "  [docs]: update build instructions"
  echo ""
  exit 1
fi

